<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple Computer//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist>
<dict>
<key>question_format</key>
<string>edu.usc.ict.npc.editor.model.processor.text.TextProcessorProvider</string>
<key>recordingQuestions</key>
<false/>
<key>answer_format</key>
<string>edu.usc.ict.npc.editor.model.processor.text.TextProcessorProvider</string>
<key>answers</key>
<array>
<dict>
<key>text</key>
<string>Hi Arno, how are you?</string>
<key>speaker</key>
<integer>1</integer>
<key>ID</key>
<string>TAB13_RACHEL01</string>
<key>tokens</key>
<array>
<integer>43</integer>
<integer>53</integer>
<integer>30</integer>
<integer>33</integer>
</array>
<key>script</key>
<string>engine.send("sb scene.command('bml char Rachel file TAB13_RACHEL01.xml')")</string>
<key>modified</key>
<date>2013-10-03T15:50:41Z</date>
</dict>
<dict>
<key>text</key>
<string>I'm great, thanks.  How can I help you?</string>
<key>speaker</key>
<integer>1</integer>
<key>ID</key>
<string>TAB13_RACHEL02</string>
<key>tokens</key>
<array>
<integer>46</integer>
<integer>53</integer>
<integer>30</integer>
<integer>33</integer>
</array>
<key>script</key>
<string>engine.send("sb scene.command('bml char Rachel file TAB13_RACHEL02.xml')")</string>
<key>modified</key>
<date>2013-10-03T15:51:25Z</date>
</dict>
<dict>
<key>text</key>
<string>As you've heard, integration, transition, dissemination and rapid authoring are the keys to creating effective and efficient virtual humans. But what does that mean?</string>
<key>speaker</key>
<integer>2</integer>
<key>ID</key>
<string>TAB13_BRAD02</string>
<key>tokens</key>
<array>
<integer>29</integer>
</array>
<key>script</key>
<string></string>
<key>modified</key>
<date>2013-10-07T15:25:06Z</date>
</dict>
<dict>
<key>text</key>
<string>For one, it means that with just a few clicks using the Toolkit...</string>
<key>speaker</key>
<integer>2</integer>
<key>ID</key>
<string>TAB13_BRAD03</string>
<key>tokens</key>
<array>
<integer>29</integer>
</array>
<key>modified</key>
<date>2013-10-07T15:34:11Z</date>
</dict>
<dict>
<key>text</key>
<string>I can be anywhere</string>
<key>speaker</key>
<integer>2</integer>
<key>ID</key>
<string>TAB13_BRAD04</string>
<key>tokens</key>
<array>
<integer>29</integer>
</array>
<key>modified</key>
<date>2013-10-07T15:34:57Z</date>
</dict>
<dict>
<key>text</key>
<string>you need me to be</string>
<key>speaker</key>
<integer>2</integer>
<key>ID</key>
<string>TAB13_BRAD05</string>
<key>tokens</key>
<array>
<integer>29</integer>
</array>
<key>modified</key>
<date>2013-10-07T15:35:25Z</date>
</dict>
<dict>
<key>text</key>
<string>Oh la la. Garcon! Cafe?</string>
<key>speaker</key>
<integer>2</integer>
<key>ID</key>
<string>TAB13_BRAD06A</string>
<key>tokens</key>
<array>
<integer>29</integer>
</array>
<key>modified</key>
<date>2013-10-07T15:35:56Z</date>
</dict>
<dict>
<key>text</key>
<string>Key to all of this is interactivity and authorability. Domain experts, end users, researchers, and developers should be able to rapidly create and modify virtual characters that are relevant to their research, training and education needs.</string>
<key>speaker</key>
<integer>2</integer>
<key>ID</key>
<string>TAB13_BRAD11</string>
<key>tokens</key>
<array>
<integer>29</integer>
</array>
<key>modified</key>
<date>2013-10-07T15:36:38Z</date>
</dict>
<dict>
<key>text</key>
<string>And that is the goal of the ICT Virtual Human Toolkit: to provide a shared platform for the creation of compelling virtual humans that can engage real humans in meaningful and realistic social interactions.</string>
<key>speaker</key>
<integer>2</integer>
<key>ID</key>
<string>TAB13_BRAD12</string>
<key>tokens</key>
<array>
<integer>29</integer>
</array>
<key>modified</key>
<date>2013-10-07T15:37:24Z</date>
</dict>
<dict>
<key>text</key>
<string>The Toolkit consists of many components that drive our virtual humans, including MultiSense, NPCEditor, NVBG and SmartBody, together with authoring tools like the Machinima Maker and VHBuilder.</string>
<key>speaker</key>
<integer>1</integer>
<key>ID</key>
<string>TAB13_RACHEL03</string>
<key>tokens</key>
<array>
<integer>49</integer>
<integer>53</integer>
<integer>30</integer>
<integer>33</integer>
</array>
<key>script</key>
<string>engine.send("sb scene.command('bml char Rachel file TAB13_RACHEL03.xml')")</string>
<key>modified</key>
<date>2013-10-03T15:51:52Z</date>
</dict>
<dict>
<key>text</key>
<string>It's a timeline authoring toll that allows you to quickly create semi-interactive cut-scenes.  Most of what you've seen so far has been authored with the Machinima Maker, and it's used in projects like sTRIVE and ELITE as well.</string>
<key>speaker</key>
<integer>1</integer>
<key>ID</key>
<string>TAB13_RACHEL04</string>
<key>tokens</key>
<array>
<integer>49</integer>
<integer>53</integer>
<integer>30</integer>
<integer>33</integer>
</array>
<key>script</key>
<string>engine.send("sb scene.command('bml char Rachel file TAB13_RACHEL04.xml')")</string>
<key>modified</key>
<date>2013-10-03T15:52:25Z</date>
</dict>
<dict>
<key>text</key>
<string>Okay okay, enough with the PowerPoint presentation. Arno, this is the ICT where research and technology meet Hollywood. Don't just tell them about the Virtual Human Toolkit, let me take them inside and show them.</string>
<key>speaker</key>
<integer>2</integer>
<key>ID</key>
<string>TAB13_BRAD01</string>
<key>tokens</key>
<array>
<integer>29</integer>
</array>
<key>modified</key>
<date>2013-10-07T12:36:04Z</date>
</dict>
<dict>
<key>text</key>
<string>Arno, you 've anything to add?</string>
<key>speaker</key>
<integer>2</integer>
<key>ID</key>
<string>TAB13_BRAD13A</string>
<key>tokens</key>
<array>
<integer>29</integer>
</array>
<key>modified</key>
<date>2013-10-07T15:38:27Z</date>
</dict>
</array>
<key>questions</key>
<array>
<dict>
<key>text</key>
<string>Rachel, tell me about the toolkit.</string>
<key>ID</key>
<string>Anybody-306</string>
<key>tokens</key>
<array>
<integer>32</integer>
</array>
<key>modified</key>
<date>2012-08-06T08:16:33Z</date>
</dict>
<dict>
<key>text</key>
<string>What is the toolkit?</string>
<key>ID</key>
<string>Anybody-324</string>
<key>tokens</key>
<array>
<integer>32</integer>
</array>
<key>modified</key>
<date>2009-10-22T20:51:24Z</date>
</dict>
<dict>
<key>text</key>
<string>Tell me about the Virtual Human Toolkit
</string>
<key>ID</key>
<string>Anybody-317</string>
<key>tokens</key>
<array>
<integer>32</integer>
</array>
<key>modified</key>
<date>2013-08-06T07:39:14Z</date>
</dict>
<dict>
<key>text</key>
<string>What can you say about the Toolkit</string>
<key>ID</key>
<string>Anybody-307</string>
<key>tokens</key>
<array>
<integer>32</integer>
</array>
<key>modified</key>
<date>2013-08-06T07:39:15Z</date>
</dict>
<dict>
<key>text</key>
<string>So what is the Virtual Human Toolkit</string>
<key>ID</key>
<string>Anybody-308</string>
<key>tokens</key>
<array>
<integer>32</integer>
</array>
<key>modified</key>
<date>2013-08-06T07:39:16Z</date>
</dict>
<dict>
<key>text</key>
<string>What is the virtual human toolkit?</string>
<key>ID</key>
<string>Anybody-318</string>
<key>tokens</key>
<array>
<integer>32</integer>
</array>
<key>modified</key>
<date>2012-10-11T15:35:30Z</date>
</dict>
<dict>
<key>text</key>
<string>What is this toolkit?</string>
<key>ID</key>
<string>Anybody-319</string>
<key>tokens</key>
<array>
<integer>32</integer>
</array>
<key>modified</key>
<date>2012-10-11T15:35:39Z</date>
</dict>
<dict>
<key>text</key>
<string>Can you describe the virtual human toolkit?</string>
<key>ID</key>
<string>Anybody-325</string>
<key>tokens</key>
<array>
<integer>32</integer>
</array>
<key>modified</key>
<date>2012-10-12T13:40:52Z</date>
</dict>
<dict>
<key>text</key>
<string>What can you tell me about the toolkit Rachel?</string>
<key>ID</key>
<string>Anybody-321</string>
<key>tokens</key>
<array>
<integer>32</integer>
</array>
<key>modified</key>
<date>2012-10-11T15:36:40Z</date>
</dict>
<dict>
<key>text</key>
<string>Can you tell me about the virtual human toolkit?</string>
<key>ID</key>
<string>Anybody-320</string>
<key>tokens</key>
<array>
<integer>32</integer>
</array>
<key>modified</key>
<date>2012-10-11T15:35:47Z</date>
</dict>
<dict>
<key>text</key>
<string>Can you describe the toolkit?</string>
<key>ID</key>
<string>Anybody-322</string>
<key>tokens</key>
<array>
<integer>32</integer>
</array>
<key>modified</key>
<date>2012-10-11T15:37:45Z</date>
</dict>
<dict>
<key>text</key>
<string>What is the tool kit?</string>
<key>ID</key>
<string>Anybody-305</string>
<key>tokens</key>
<array>
<integer>32</integer>
</array>
<key>modified</key>
<date>2009-10-15T17:44:26Z</date>
</dict>
<dict>
<key>text</key>
<string>So what is this toolkit?</string>
<key>ID</key>
<string>Anybody-309</string>
<key>tokens</key>
<array>
<integer>32</integer>
</array>
<key>modified</key>
<date>2009-10-15T17:44:36Z</date>
</dict>
<dict>
<key>text</key>
<string>What's this Virtual Human Toolkit you keep talking about?</string>
<key>ID</key>
<string>Anybody-310</string>
<key>tokens</key>
<array>
<integer>32</integer>
</array>
<key>modified</key>
<date>2009-10-15T17:44:54Z</date>
</dict>
<dict>
<key>text</key>
<string>What makes up the toolkit?</string>
<key>ID</key>
<string>Anybody-323</string>
<key>tokens</key>
<array>
<integer>32</integer>
</array>
<key>modified</key>
<date>2012-10-11T15:37:54Z</date>
</dict>
<dict>
<key>text</key>
<string>I'm good.  How're you doing?</string>
<key>ID</key>
<string>Anybody-203</string>
<key>tokens</key>
<array>
<integer>32</integer>
</array>
<key>modified</key>
<date>2009-10-15T17:05:17Z</date>
</dict>
<dict>
<key>text</key>
<string>Good!  How are you doing?</string>
<key>ID</key>
<string>Anybody-204</string>
<key>tokens</key>
<array>
<integer>32</integer>
</array>
<key>modified</key>
<date>2009-10-15T17:29:40Z</date>
</dict>
<dict>
<key>text</key>
<string>I'm good. How are you doing Rachel?</string>
<key>ID</key>
<string>Anybody-201</string>
<key>tokens</key>
<array>
<integer>32</integer>
</array>
<key>modified</key>
<date>2012-09-27T08:28:30Z</date>
</dict>
<dict>
<key>text</key>
<string>Well, could you tell me what's in the v h Toolkit?</string>
<key>ID</key>
<string>Anybody-304</string>
<key>tokens</key>
<array>
<integer>32</integer>
</array>
<key>modified</key>
<date>2013-10-03T17:13:04Z</date>
</dict>
<dict>
<key>text</key>
<string>tell me what's in the virtual human Toolkit?</string>
<key>ID</key>
<string>Anybody-315</string>
<key>tokens</key>
<array>
<integer>32</integer>
</array>
<key>modified</key>
<date>2013-10-03T17:13:26Z</date>
</dict>
<dict>
<key>text</key>
<string>Tell me what's in the vh Toolkit?</string>
<key>ID</key>
<string>Anybody-316</string>
<key>tokens</key>
<array>
<integer>32</integer>
</array>
<key>modified</key>
<date>2013-10-03T17:13:44Z</date>
</dict>
<dict>
<key>text</key>
<string>Well, could you tell me what's in the Toolkit?</string>
<key>ID</key>
<string>Anybody-302</string>
<key>tokens</key>
<array>
<integer>32</integer>
</array>
<key>modified</key>
<date>2013-10-03T17:11:17Z</date>
</dict>
<dict>
<key>text</key>
<string>Well, could you tell me what's in the virtual human Toolkit?</string>
<key>ID</key>
<string>Anybody-303</string>
<key>tokens</key>
<array>
<integer>32</integer>
</array>
<key>modified</key>
<date>2013-10-03T17:11:54Z</date>
</dict>
<dict>
<key>text</key>
<string>I'm good, how's your day going?</string>
<key>ID</key>
<string>Anybody-205</string>
<key>tokens</key>
<array>
<integer>32</integer>
</array>
<key>modified</key>
<date>2009-10-15T17:29:52Z</date>
</dict>
<dict>
<key>text</key>
<string>I'm good, how are you doing today?</string>
<key>ID</key>
<string>Anybody-202</string>
<key>tokens</key>
<array>
<integer>32</integer>
</array>
<key>modified</key>
<date>2012-09-27T08:17:49Z</date>
</dict>
<dict>
<key>text</key>
<string>I am doing great.</string>
<key>ID</key>
<string>Anybody-207</string>
<key>tokens</key>
<array>
<integer>32</integer>
</array>
<key>modified</key>
<date>2009-10-15T17:35:41Z</date>
</dict>
<dict>
<key>text</key>
<string>I'm doing pretty well.</string>
<key>ID</key>
<string>Anybody-208</string>
<key>tokens</key>
<array>
<integer>32</integer>
</array>
<key>modified</key>
<date>2009-10-15T17:36:03Z</date>
</dict>
<dict>
<key>text</key>
<string>I'm good.</string>
<key>ID</key>
<string>Anybody-209</string>
<key>tokens</key>
<array>
<integer>32</integer>
</array>
<key>modified</key>
<date>2009-10-15T17:36:15Z</date>
</dict>
<dict>
<key>text</key>
<string>Good.  You?</string>
<key>ID</key>
<string>Anybody-206</string>
<key>tokens</key>
<array>
<integer>32</integer>
</array>
<key>modified</key>
<date>2009-11-23T18:27:45Z</date>
</dict>
<dict>
<key>text</key>
<string>I am okay.</string>
<key>ID</key>
<string>Anybody-210</string>
<key>tokens</key>
<array>
<integer>32</integer>
</array>
<key>modified</key>
<date>2009-10-15T17:36:24Z</date>
</dict>
<dict>
<key>text</key>
<string>I'm ok.</string>
<key>ID</key>
<string>Anybody-211</string>
<key>tokens</key>
<array>
<integer>32</integer>
</array>
<key>modified</key>
<date>2009-10-15T17:36:50Z</date>
</dict>
<dict>
<key>text</key>
<string>What can you tell me about the Machinima Maker.</string>
<key>ID</key>
<string>Anybody-405</string>
<key>tokens</key>
<array>
<integer>32</integer>
</array>
<key>modified</key>
<date>2009-10-22T19:50:21Z</date>
</dict>
<dict>
<key>text</key>
<string>Machinima Maker, what's that?</string>
<key>ID</key>
<string>Anybody-404</string>
<key>tokens</key>
<array>
<integer>32</integer>
</array>
<key>modified</key>
<date>2013-10-03T17:27:21Z</date>
</dict>
<dict>
<key>text</key>
<string>Tell me about the Machinima Maker.</string>
<key>ID</key>
<string>Anybody-403</string>
<key>tokens</key>
<array>
<integer>32</integer>
</array>
<key>modified</key>
<date>2013-10-03T17:26:59Z</date>
</dict>
<dict>
<key>text</key>
<string>How does the Machinima Maker work?</string>
<key>ID</key>
<string>Anybody-402</string>
<key>tokens</key>
<array>
<integer>32</integer>
</array>
<key>modified</key>
<date>2009-10-22T19:52:17Z</date>
</dict>
<dict>
<key>text</key>
<string>What is the Machinima Maker?</string>
<key>ID</key>
<string>Anybody-401</string>
<key>tokens</key>
<array>
<integer>32</integer>
</array>
<key>modified</key>
<date>2009-10-22T19:52:33Z</date>
</dict>
<dict>
<key>text</key>
<string>I'm good, how are you?</string>
<key>ID</key>
<string>Anybody-200</string>
<key>tokens</key>
<array>
<integer>32</integer>
</array>
<key>modified</key>
<date>2009-10-22T19:48:56Z</date>
</dict>
<dict>
<key>text</key>
<string>Well, could you tell everyone what's in the Toolkit?</string>
<key>ID</key>
<string>Anybody-300</string>
<key>tokens</key>
<array>
<integer>32</integer>
</array>
<key>modified</key>
<date>2013-10-03T15:54:51Z</date>
</dict>
<dict>
<key>text</key>
<string>Well, could you tell everyone what's in the v h Toolkit?</string>
<key>ID</key>
<string>Anybody-301</string>
<key>tokens</key>
<array>
<integer>32</integer>
</array>
<key>modified</key>
<date>2013-10-03T16:02:27Z</date>
</dict>
<dict>
<key>text</key>
<string>Tell us what's in the toolkit.</string>
<key>ID</key>
<string>Anybody-311</string>
<key>tokens</key>
<array>
<integer>32</integer>
</array>
<key>modified</key>
<date>2013-10-03T16:04:51Z</date>
</dict>
<dict>
<key>text</key>
<string>what's in the virtual human toolkit?</string>
<key>ID</key>
<string>Anybody-312</string>
<key>tokens</key>
<array>
<integer>32</integer>
</array>
<key>modified</key>
<date>2013-10-03T16:05:24Z</date>
</dict>
<dict>
<key>text</key>
<string>Tell me what's in the toolkit</string>
<key>ID</key>
<string>Anybody-313</string>
<key>tokens</key>
<array>
<integer>32</integer>
</array>
<key>modified</key>
<date>2013-10-03T16:06:42Z</date>
</dict>
<dict>
<key>text</key>
<string>Rachel, what's in the toolkit?</string>
<key>ID</key>
<string>Anybody-314</string>
<key>tokens</key>
<array>
<integer>32</integer>
</array>
<key>modified</key>
<date>2013-10-03T16:07:08Z</date>
</dict>
<dict>
<key>text</key>
<string>What's the Machinima Maker?</string>
<key>ID</key>
<string>Anybody-400</string>
<key>tokens</key>
<array>
<integer>32</integer>
</array>
<key>modified</key>
<date>2013-10-03T16:07:30Z</date>
</dict>
</array>
<key>speakers</key>
<array>
<dict>
<key>lastName</key>
<string>Campus</string>
<key>parent</key>
<integer>1</integer>
<key>class</key>
<string>edu.usc.ict.npc.editor.model.Person</string>
</dict>
<dict>
<key>lastName</key>
<string>General</string>
<key>contentRecencyLimit</key>
<integer>4</integer>
<key>class</key>
<string>edu.usc.ict.npc.editor.dialog.blackwell.BlackwellPerson</string>
<key>randomChoiceRecencyLimit</key>
<integer>10</integer>
<key>firstName</key>
<string></string>
<key>offtopicInitiativeThreshold</key>
<integer>2</integer>
</dict>
<dict>
<key>lastName</key>
<string>House</string>
<key>parent</key>
<integer>1</integer>
<key>class</key>
<string>edu.usc.ict.npc.editor.model.Person</string>
</dict>
</array>
<key>searcherSessions</key>
<array>
<dict>
<key>param</key>
<string>0.21218809611778594 0.9999995765315646 0.047444834311267954 0.8926795118019091 0.5126667233146482 0.6505929201841947 -0.6415795981884003</string>
<key>aid</key>
<integer>2</integer>
</dict>
<dict>
<key>param</key>
<string>0.20974359828040373 0.9999999999976726 0.8999999652974165 0.7488979040060673 0.37935370032727134 0.7684520340439979 -9.14671593674199E-12</string>
<key>aid</key>
<integer>1</integer>
</dict>
</array>
<key>trainingOnTestQuestions</key>
<false/>
<key>version</key>
<integer>4</integer>
<key>keepingLinkEstimatesUpdated</key>
<false/>
<key>map</key>
<array>
<dict>
<key>value</key>
<integer>6</integer>
<key>qid</key>
<integer>0</integer>
<key>aid</key>
<integer>9</integer>
</dict>
<dict>
<key>value</key>
<integer>6</integer>
<key>qid</key>
<integer>1</integer>
<key>aid</key>
<integer>9</integer>
</dict>
<dict>
<key>value</key>
<integer>6</integer>
<key>qid</key>
<integer>2</integer>
<key>aid</key>
<integer>9</integer>
</dict>
<dict>
<key>value</key>
<integer>6</integer>
<key>qid</key>
<integer>3</integer>
<key>aid</key>
<integer>9</integer>
</dict>
<dict>
<key>value</key>
<integer>6</integer>
<key>qid</key>
<integer>4</integer>
<key>aid</key>
<integer>9</integer>
</dict>
<dict>
<key>value</key>
<integer>6</integer>
<key>qid</key>
<integer>5</integer>
<key>aid</key>
<integer>9</integer>
</dict>
<dict>
<key>value</key>
<integer>6</integer>
<key>qid</key>
<integer>6</integer>
<key>aid</key>
<integer>9</integer>
</dict>
<dict>
<key>value</key>
<integer>6</integer>
<key>qid</key>
<integer>7</integer>
<key>aid</key>
<integer>9</integer>
</dict>
<dict>
<key>value</key>
<integer>6</integer>
<key>qid</key>
<integer>8</integer>
<key>aid</key>
<integer>9</integer>
</dict>
<dict>
<key>value</key>
<integer>6</integer>
<key>qid</key>
<integer>9</integer>
<key>aid</key>
<integer>9</integer>
</dict>
<dict>
<key>value</key>
<integer>6</integer>
<key>qid</key>
<integer>10</integer>
<key>aid</key>
<integer>9</integer>
</dict>
<dict>
<key>value</key>
<integer>6</integer>
<key>qid</key>
<integer>11</integer>
<key>aid</key>
<integer>9</integer>
</dict>
<dict>
<key>value</key>
<integer>6</integer>
<key>qid</key>
<integer>12</integer>
<key>aid</key>
<integer>9</integer>
</dict>
<dict>
<key>value</key>
<integer>6</integer>
<key>qid</key>
<integer>13</integer>
<key>aid</key>
<integer>9</integer>
</dict>
<dict>
<key>value</key>
<integer>6</integer>
<key>qid</key>
<integer>14</integer>
<key>aid</key>
<integer>9</integer>
</dict>
<dict>
<key>value</key>
<integer>6</integer>
<key>qid</key>
<integer>15</integer>
<key>aid</key>
<integer>1</integer>
</dict>
<dict>
<key>value</key>
<integer>6</integer>
<key>qid</key>
<integer>16</integer>
<key>aid</key>
<integer>1</integer>
</dict>
<dict>
<key>value</key>
<integer>6</integer>
<key>qid</key>
<integer>17</integer>
<key>aid</key>
<integer>1</integer>
</dict>
<dict>
<key>value</key>
<integer>6</integer>
<key>qid</key>
<integer>18</integer>
<key>aid</key>
<integer>9</integer>
</dict>
<dict>
<key>value</key>
<integer>6</integer>
<key>qid</key>
<integer>19</integer>
<key>aid</key>
<integer>9</integer>
</dict>
<dict>
<key>value</key>
<integer>6</integer>
<key>qid</key>
<integer>20</integer>
<key>aid</key>
<integer>9</integer>
</dict>
<dict>
<key>value</key>
<integer>6</integer>
<key>qid</key>
<integer>21</integer>
<key>aid</key>
<integer>9</integer>
</dict>
<dict>
<key>value</key>
<integer>6</integer>
<key>qid</key>
<integer>22</integer>
<key>aid</key>
<integer>9</integer>
</dict>
<dict>
<key>value</key>
<integer>6</integer>
<key>qid</key>
<integer>23</integer>
<key>aid</key>
<integer>1</integer>
</dict>
<dict>
<key>value</key>
<integer>6</integer>
<key>qid</key>
<integer>24</integer>
<key>aid</key>
<integer>1</integer>
</dict>
<dict>
<key>value</key>
<integer>6</integer>
<key>qid</key>
<integer>25</integer>
<key>aid</key>
<integer>1</integer>
</dict>
<dict>
<key>value</key>
<integer>6</integer>
<key>qid</key>
<integer>26</integer>
<key>aid</key>
<integer>1</integer>
</dict>
<dict>
<key>value</key>
<integer>6</integer>
<key>qid</key>
<integer>27</integer>
<key>aid</key>
<integer>1</integer>
</dict>
<dict>
<key>value</key>
<integer>6</integer>
<key>qid</key>
<integer>28</integer>
<key>aid</key>
<integer>1</integer>
</dict>
<dict>
<key>value</key>
<integer>6</integer>
<key>qid</key>
<integer>29</integer>
<key>aid</key>
<integer>1</integer>
</dict>
<dict>
<key>value</key>
<integer>6</integer>
<key>qid</key>
<integer>30</integer>
<key>aid</key>
<integer>1</integer>
</dict>
<dict>
<key>value</key>
<integer>6</integer>
<key>qid</key>
<integer>31</integer>
<key>aid</key>
<integer>10</integer>
</dict>
<dict>
<key>value</key>
<integer>6</integer>
<key>qid</key>
<integer>32</integer>
<key>aid</key>
<integer>10</integer>
</dict>
<dict>
<key>value</key>
<integer>6</integer>
<key>qid</key>
<integer>33</integer>
<key>aid</key>
<integer>10</integer>
</dict>
<dict>
<key>value</key>
<integer>6</integer>
<key>qid</key>
<integer>34</integer>
<key>aid</key>
<integer>10</integer>
</dict>
<dict>
<key>value</key>
<integer>6</integer>
<key>qid</key>
<integer>35</integer>
<key>aid</key>
<integer>10</integer>
</dict>
<dict>
<key>value</key>
<integer>6</integer>
<key>qid</key>
<integer>36</integer>
<key>aid</key>
<integer>1</integer>
</dict>
<dict>
<key>value</key>
<integer>6</integer>
<key>qid</key>
<integer>37</integer>
<key>aid</key>
<integer>9</integer>
</dict>
<dict>
<key>value</key>
<integer>6</integer>
<key>qid</key>
<integer>38</integer>
<key>aid</key>
<integer>9</integer>
</dict>
<dict>
<key>value</key>
<integer>6</integer>
<key>qid</key>
<integer>39</integer>
<key>aid</key>
<integer>9</integer>
</dict>
<dict>
<key>value</key>
<integer>6</integer>
<key>qid</key>
<integer>40</integer>
<key>aid</key>
<integer>9</integer>
</dict>
<dict>
<key>value</key>
<integer>6</integer>
<key>qid</key>
<integer>41</integer>
<key>aid</key>
<integer>9</integer>
</dict>
<dict>
<key>value</key>
<integer>6</integer>
<key>qid</key>
<integer>42</integer>
<key>aid</key>
<integer>9</integer>
</dict>
<dict>
<key>value</key>
<integer>6</integer>
<key>qid</key>
<integer>43</integer>
<key>aid</key>
<integer>10</integer>
</dict>
</array>
<key>categories</key>
<array>
<dict>
<key>chatEditingAllowed</key>
<false/>
<key>answerCategory</key>
<false/>
<key>readOnly</key>
<true/>
<key>classifierCategory</key>
<false/>
<key>name</key>
<string>Train/Test</string>
<key>ID</key>
<string>train_test</string>
<key>tokens</key>
<array>
<dict>
<key>name</key>
<string>Training</string>
<key>ID</key>
<string>train</string>
<key>colorAsInt</key>
<integer>0</integer>
</dict>
<dict>
<key>name</key>
<string>Test</string>
<key>ID</key>
<string>test</string>
<key>colorAsInt</key>
<integer>0</integer>
</dict>
</array>
<key>answerEditingAllowed</key>
<false/>
<key>questionCategory</key>
<true/>
<key>questionEditingAllowed</key>
<false/>
<key>answerColumnVisible</key>
<false/>
<key>questionColumnVisible</key>
<false/>
</dict>
<dict>
<key>chatEditingAllowed</key>
<false/>
<key>answerCategory</key>
<true/>
<key>readOnly</key>
<true/>
<key>classifierCategory</key>
<false/>
<key>name</key>
<string>Dialog State</string>
<key>ID</key>
<string>dialogState</string>
<key>tokens</key>
<array>
<dict>
<key>description</key>
<string>Do not change dialog state</string>
<key>name</key>
<string>none</string>
<key>ID</key>
<string>none</string>
<key>colorAsInt</key>
<integer>0</integer>
</dict>
<dict>
<key>description</key>
<string>Add tokens for undefined categories to the state, do not change the existing categories</string>
<key>name</key>
<string>add</string>
<key>ID</key>
<string>add</string>
<key>colorAsInt</key>
<integer>0</integer>
</dict>
<dict>
<key>description</key>
<string>Add tokens replacing existing category values</string>
<key>name</key>
<string>set</string>
<key>ID</key>
<string>set</string>
<key>colorAsInt</key>
<integer>0</integer>
</dict>
<dict>
<key>description</key>
<string>Clear dialog state and then set it to given tokens</string>
<key>name</key>
<string>reset</string>
<key>ID</key>
<string>reset</string>
<key>colorAsInt</key>
<integer>0</integer>
</dict>
</array>
<key>answerEditingAllowed</key>
<false/>
<key>questionCategory</key>
<false/>
<key>questionEditingAllowed</key>
<false/>
<key>answerColumnVisible</key>
<false/>
<key>questionColumnVisible</key>
<false/>
</dict>
<dict>
<key>chatEditingAllowed</key>
<false/>
<key>answerCategory</key>
<false/>
<key>readOnly</key>
<false/>
<key>classifierCategory</key>
<false/>
<key>name</key>
<string>Tone</string>
<key>ID</key>
<string>tone</string>
<key>tokens</key>
<array>
<dict>
<key>name</key>
<string>Down</string>
<key>ID</key>
<string>down</string>
<key>colorAsInt</key>
<integer>0</integer>
</dict>
<dict>
<key>name</key>
<string>Flat</string>
<key>ID</key>
<string>flat</string>
<key>colorAsInt</key>
<integer>0</integer>
</dict>
<dict>
<key>name</key>
<string>Up</string>
<key>ID</key>
<string>up</string>
<key>colorAsInt</key>
<integer>0</integer>
</dict>
</array>
<key>answerEditingAllowed</key>
<false/>
<key>questionCategory</key>
<true/>
<key>questionEditingAllowed</key>
<false/>
<key>answerColumnVisible</key>
<false/>
<key>questionColumnVisible</key>
<false/>
</dict>
<dict>
<key>chatEditingAllowed</key>
<false/>
<key>answerCategory</key>
<false/>
<key>readOnly</key>
<true/>
<key>classifierCategory</key>
<false/>
<key>name</key>
<string>Emotion</string>
<key>ID</key>
<string>emotion</string>
<key>tokens</key>
<array>
<dict>
<key>name</key>
<string>Neutral</string>
<key>ID</key>
<string>neutral</string>
<key>colorAsInt</key>
<integer>0</integer>
</dict>
<dict>
<key>name</key>
<string>Negative</string>
<key>ID</key>
<string>negative</string>
<key>colorAsInt</key>
<integer>0</integer>
</dict>
</array>
<key>answerEditingAllowed</key>
<false/>
<key>questionCategory</key>
<true/>
<key>questionEditingAllowed</key>
<false/>
<key>answerColumnVisible</key>
<false/>
<key>questionColumnVisible</key>
<false/>
</dict>
<dict>
<key>chatEditingAllowed</key>
<false/>
<key>answerCategory</key>
<true/>
<key>readOnly</key>
<true/>
<key>classifierCategory</key>
<false/>
<key>name</key>
<string>Toss</string>
<key>ID</key>
<string>toss</string>
<key>tokens</key>
<array>
<dict>
<key>description</key>
<string></string>
<key>name</key>
<string>Campus</string>
<key>ID</key>
<string>Campus</string>
<key>colorAsInt</key>
<integer>0</integer>
</dict>
<dict>
<key>description</key>
<string></string>
<key>name</key>
<string>General</string>
<key>ID</key>
<string>General</string>
<key>colorAsInt</key>
<integer>0</integer>
</dict>
<dict>
<key>description</key>
<string></string>
<key>name</key>
<string>House</string>
<key>ID</key>
<string>House</string>
<key>colorAsInt</key>
<integer>0</integer>
</dict>
</array>
<key>answerEditingAllowed</key>
<true/>
<key>questionCategory</key>
<false/>
<key>questionEditingAllowed</key>
<false/>
<key>answerColumnVisible</key>
<false/>
<key>questionColumnVisible</key>
<false/>
</dict>
<dict>
<key>chatEditingAllowed</key>
<false/>
<key>answerCategory</key>
<true/>
<key>readOnly</key>
<true/>
<key>classifierCategory</key>
<false/>
<key>name</key>
<string>Type</string>
<key>ID</key>
<string>type</string>
<key>tokens</key>
<array>
<dict>
<key>description</key>
<string>alternative</string>
<key>name</key>
<string>alternative</string>
<key>ID</key>
<string>alternative</string>
<key>colorAsInt</key>
<integer>0</integer>
</dict>
<dict>
<key>description</key>
<string>brushoff</string>
<key>name</key>
<string>brushoff</string>
<key>ID</key>
<string>brushoff</string>
<key>colorAsInt</key>
<integer>0</integer>
</dict>
<dict>
<key>description</key>
<string>conceal</string>
<key>name</key>
<string>conceal</string>
<key>ID</key>
<string>conceal</string>
<key>colorAsInt</key>
<integer>0</integer>
</dict>
<dict>
<key>description</key>
<string>content</string>
<key>name</key>
<string>content</string>
<key>ID</key>
<string>content</string>
<key>colorAsInt</key>
<integer>0</integer>
</dict>
<dict>
<key>description</key>
<string>delayed</string>
<key>name</key>
<string>delayed</string>
<key>ID</key>
<string>delayed</string>
<key>colorAsInt</key>
<integer>0</integer>
</dict>
<dict>
<key>description</key>
<string>opaque</string>
<key>name</key>
<string>opaque</string>
<key>ID</key>
<string>opaque</string>
<key>colorAsInt</key>
<integer>0</integer>
</dict>
<dict>
<key>description</key>
<string>pre repeat</string>
<key>name</key>
<string>prerepeat</string>
<key>ID</key>
<string>pre repeat</string>
<key>colorAsInt</key>
<integer>0</integer>
</dict>
<dict>
<key>description</key>
<string>repeat</string>
<key>name</key>
<string>repeat</string>
<key>ID</key>
<string>repeat</string>
<key>colorAsInt</key>
<integer>0</integer>
</dict>
<dict>
<key>description</key>
<string>toss</string>
<key>name</key>
<string>toss</string>
<key>ID</key>
<string>toss</string>
<key>colorAsInt</key>
<integer>0</integer>
</dict>
<dict>
<key>description</key>
<string>unknown</string>
<key>name</key>
<string>unknown</string>
<key>ID</key>
<string>unknown</string>
<key>colorAsInt</key>
<integer>0</integer>
</dict>
<dict>
<key>description</key>
<string>unrelated</string>
<key>name</key>
<string>unrelated</string>
<key>ID</key>
<string>unrelated</string>
<key>colorAsInt</key>
<integer>0</integer>
</dict>
<dict>
<key>description</key>
<string>opening</string>
<key>name</key>
<string>opening</string>
<key>ID</key>
<string>opening</string>
<key>colorAsInt</key>
<integer>0</integer>
</dict>
<dict>
<key>description</key>
<string>closing</string>
<key>name</key>
<string>closing</string>
<key>ID</key>
<string>closing</string>
<key>colorAsInt</key>
<integer>0</integer>
</dict>
<dict>
<key>description</key>
<string>once</string>
<key>name</key>
<string>once</string>
<key>ID</key>
<string>once</string>
<key>colorAsInt</key>
<integer>0</integer>
</dict>
</array>
<key>answerEditingAllowed</key>
<true/>
<key>questionCategory</key>
<false/>
<key>questionEditingAllowed</key>
<false/>
<key>answerColumnVisible</key>
<true/>
<key>questionColumnVisible</key>
<false/>
</dict>
<dict>
<key>chatEditingAllowed</key>
<false/>
<key>answerCategory</key>
<true/>
<key>readOnly</key>
<false/>
<key>classifierCategory</key>
<false/>
<key>name</key>
<string>Speaker</string>
<key>ID</key>
<string>speaker</string>
<key>tokens</key>
<array>
<dict>
<key>name</key>
<string>brad</string>
<key>ID</key>
<string>brad</string>
<key>colorAsInt</key>
<integer>-4346261</integer>
</dict>
<dict>
<key>description</key>
<string>New Brad</string>
<key>name</key>
<string>Brad</string>
<key>ID</key>
<string>Brad</string>
<key>colorAsInt</key>
<integer>-2263458</integer>
</dict>
<dict>
<key>description</key>
<string>Rachel</string>
<key>name</key>
<string>Rachel</string>
<key>ID</key>
<string>Rachel</string>
<key>colorAsInt</key>
<integer>-16724788</integer>
</dict>
</array>
<key>answerEditingAllowed</key>
<true/>
<key>questionCategory</key>
<false/>
<key>questionEditingAllowed</key>
<false/>
<key>answerColumnVisible</key>
<true/>
<key>questionColumnVisible</key>
<false/>
</dict>
<dict>
<key>chatEditingAllowed</key>
<true/>
<key>answerCategory</key>
<true/>
<key>readOnly</key>
<false/>
<key>classifierCategory</key>
<true/>
<key>name</key>
<string>Addressee</string>
<key>ID</key>
<string>addressee</string>
<key>tokens</key>
<array>
<dict>
<key>name</key>
<string>Brad</string>
<key>ID</key>
<string>Brad</string>
<key>colorAsInt</key>
<integer>-2263458</integer>
</dict>
<dict>
<key>name</key>
<string>Rachel</string>
<key>ID</key>
<string>Rachel</string>
<key>colorAsInt</key>
<integer>-16724788</integer>
</dict>
<dict>
<key>name</key>
<string>Camera</string>
<key>ID</key>
<string>Camera</string>
<key>colorAsInt</key>
<integer>0</integer>
</dict>
</array>
<key>answerEditingAllowed</key>
<true/>
<key>questionCategory</key>
<true/>
<key>questionEditingAllowed</key>
<true/>
<key>answerColumnVisible</key>
<true/>
<key>questionColumnVisible</key>
<false/>
</dict>
<dict>
<key>chatEditingAllowed</key>
<false/>
<key>answerCategory</key>
<true/>
<key>readOnly</key>
<false/>
<key>classifierCategory</key>
<false/>
<key>name</key>
<string>Topic</string>
<key>ID</key>
<string>topic</string>
<key>tokens</key>
<array>
<dict>
<key>name</key>
<string>Brad</string>
<key>ID</key>
<string>brad</string>
<key>colorAsInt</key>
<integer>0</integer>
</dict>
<dict>
<key>name</key>
<string>General</string>
<key>ID</key>
<string>General</string>
<key>colorAsInt</key>
<integer>0</integer>
</dict>
<dict>
<key>name</key>
<string>ICT</string>
<key>ID</key>
<string>ict</string>
<key>colorAsInt</key>
<integer>0</integer>
</dict>
<dict>
<key>name</key>
<string>Intro</string>
<key>ID</key>
<string>Intro</string>
<key>colorAsInt</key>
<integer>-16711681</integer>
</dict>
<dict>
<key>description</key>
<string>Modules and Components</string>
<key>name</key>
<string>Module</string>
<key>ID</key>
<string>Module</string>
<key>colorAsInt</key>
<integer>0</integer>
</dict>
<dict>
<key>name</key>
<string>NPCEditor</string>
<key>ID</key>
<string>npceditor</string>
<key>colorAsInt</key>
<integer>0</integer>
</dict>
<dict>
<key>name</key>
<string>NVBG</string>
<key>ID</key>
<string>nvbg</string>
<key>colorAsInt</key>
<integer>0</integer>
</dict>
<dict>
<key>name</key>
<string>People</string>
<key>ID</key>
<string>people</string>
<key>colorAsInt</key>
<integer>0</integer>
</dict>
<dict>
<key>name</key>
<string>Projects</string>
<key>ID</key>
<string>projects</string>
<key>colorAsInt</key>
<integer>0</integer>
</dict>
<dict>
<key>description</key>
<string>About Rachel</string>
<key>name</key>
<string>Rachel</string>
<key>ID</key>
<string>Rachel</string>
<key>colorAsInt</key>
<integer>0</integer>
</dict>
<dict>
<key>name</key>
<string>Renderer</string>
<key>ID</key>
<string>renderer</string>
<key>colorAsInt</key>
<integer>0</integer>
</dict>
<dict>
<key>description</key>
<string>Scripts</string>
<key>name</key>
<string>Script</string>
<key>ID</key>
<string>Script</string>
<key>colorAsInt</key>
<integer>0</integer>
</dict>
<dict>
<key>description</key>
<string>Smalltalk and conersational lines</string>
<key>name</key>
<string>Smalltalk</string>
<key>ID</key>
<string>Smalltalk</string>
<key>colorAsInt</key>
<integer>0</integer>
</dict>
<dict>
<key>name</key>
<string>SmartBody</string>
<key>ID</key>
<string>smartbody</string>
<key>colorAsInt</key>
<integer>0</integer>
</dict>
<dict>
<key>description</key>
<string>ASR and TTS</string>
<key>name</key>
<string>Speech</string>
<key>ID</key>
<string>Speech</string>
<key>colorAsInt</key>
<integer>0</integer>
</dict>
<dict>
<key>name</key>
<string>Toolkit</string>
<key>ID</key>
<string>toolkit</string>
<key>colorAsInt</key>
<integer>0</integer>
</dict>
<dict>
<key>name</key>
<string>USC</string>
<key>ID</key>
<string>usc</string>
<key>colorAsInt</key>
<integer>0</integer>
</dict>
<dict>
<key>name</key>
<string>Voice</string>
<key>ID</key>
<string>voice</string>
<key>colorAsInt</key>
<integer>0</integer>
</dict>
<dict>
<key>name</key>
<string>Watson</string>
<key>ID</key>
<string>watson</string>
<key>colorAsInt</key>
<integer>0</integer>
</dict>
</array>
<key>answerEditingAllowed</key>
<true/>
<key>questionCategory</key>
<false/>
<key>questionEditingAllowed</key>
<true/>
<key>answerColumnVisible</key>
<true/>
<key>questionColumnVisible</key>
<true/>
</dict>
<dict>
<key>chatEditingAllowed</key>
<false/>
<key>answerCategory</key>
<true/>
<key>answerEditingAllowed</key>
<true/>
<key>questionColumnVisible</key>
<true/>
<key>classifierCategory</key>
<false/>
<key>readOnly</key>
<false/>
<key>description</key>
<string>Prerecorded samples or TTS</string>
<key>name</key>
<string>Sound</string>
<key>ID</key>
<string>sound</string>
<key>tokens</key>
<array>
<dict>
<key>name</key>
<string>Prerecorded</string>
<key>ID</key>
<string>true</string>
<key>colorAsInt</key>
<integer>-16724788</integer>
</dict>
<dict>
<key>name</key>
<string>TTS</string>
<key>ID</key>
<string>false</string>
<key>colorAsInt</key>
<integer>-6750157</integer>
</dict>
</array>
<key>questionCategory</key>
<false/>
<key>questionEditingAllowed</key>
<true/>
<key>answerColumnVisible</key>
<true/>
</dict>
</array>
<key>dialog_manager</key>
<dict>
<key>param</key>
<dict>
<key>useScriptFile</key>
<false/>
<key>storedScriptFileName</key>
<string>0file:/D:/svn_vhtoolkit/data/classifier/VHTK.groovy</string>
<key>scriptText</key>
<string>// ============================================================================
// dm.java
// ============================================================================
//
//  Created by leuski on Aug 22, 2009.
//  Copyright (c) 2009 Anton Leuski. All rights reserved.
//
// ============================================================================


package edu.usc.ict.npc.editor.dialog.script.dm;

import edu.usc.ict.npc.editor.dialog.script.*
import java.awt.event.ActionListener
import java.awt.event.ActionEvent;
import javax.swing.Timer;

class Global implements ActionListener {

	public final static String	kConceal		= "conceal";
	public final static String	kUnknown		= "unknown";
	public final static String	kOpaque			= "opaque";
	public final static String	kAlternative	= "alternative";
	public final static String	kRepeat			= "repeat";
	public final static String	kPrompt			= "prompt";

	final static String kCharacterIgnore		= 'ignore';
	final static Event	kInitiativeTimerEvent	= new Event(Event.kDispatchHint, "dm_prompt");
	public final static int		kHistoryWindow			= 10;
	final static double	kWaitBeforePrompt		= 5; // seconds
	

	Engine	engine;
	String	domainName = null;	

	Regular		regularState;
	State		currentState;
	Interrupted interrupted;
	IdentifyAddressee addressee = null;

	Map&lt;String,Object&gt;		lastUtterance;
	Event 					lastSpeechEvent;
	boolean					microphoneEnabled;
	long					lastUserStartedSpeaking;
	long					lastUserStoppedSpeaking;
	long					lastCharacterStoppedSpeaking;
	long					lastCharacterStartedSpeaking;

	Global(Engine inEngine) {
		engine = inEngine;
	}

	public Set getPresentCharacters() {
		return (Set)engine.context.presentCharacters;
	}

	public void reset() {
		engine.reset();		

		// initialize global variables here
		

		clear();

		regularState	= new Regular(this);
		interrupted		= new Interrupted(this);
		addressee = new IdentifyAddressee(this);

		enterState(regularState);
	}

	public void actionPerformed(ActionEvent e) {
		Timer	thisTimer	= (Timer)e.getSource();
		if (engine.context.initiativeTimer != thisTimer) {
			thisTimer.stop();
			return;
		}
		engine?.postEvent(kInitiativeTimerEvent);
	}

	public void clear() {
		engine.context.presentCharacters	= new HashSet();
		lastUtterance	= null;
		lastSpeechEvent	= null;

		Timer	timer	= new Timer(1000, this);	// This timer will periodically trigger executor events 
		timer.setRepeats(true);
		timer.start();
		engine.context.initiativeTimer = timer;
	}

	public void setMicrophoneEnabled(boolean inEnabled) {
		if (microphoneEnabled == inEnabled) return;
		microphoneEnabled	= inEnabled;
		engine.send(inEnabled ? "TO_ASR &lt;start id=\"temp\"&gt;" : "TO_ASR &lt;stop id=\"temp\"&gt;");
	}

	public void exitState(State inTarget) {
		inTarget?.onexit();
		engine.removeTrigger(inTarget);
	}

	public void enterState(State inTarget) {
		currentState	= inTarget;
		engine.addTrigger(inTarget);
		inTarget?.onentry();
	}

	public void transitionTo(State inTarget) {
		exitState(currentState);
		enterState(inTarget);
	}
}

Global	global			= new Global(engine);

public class State implements Trigger {

	Global 		global;

	Engine		getEngine() 				{ return global.engine; }	

	State(Global inGlobal) {
		global	= inGlobal;
		global.setMicrophoneEnabled(true);
		global.setMicrophoneEnabled(false);
	}

	public boolean handle(Event event) {

//		System.out.println(event);

		return false;
	}

	public boolean npcBehavior_done(Event event) {
		global.lastCharacterStoppedSpeaking	= System.currentTimeMillis();
		if (event?.utterance?.toss)
			return handleToss(event);
		return false;
	}

	public boolean handleToss(Event event) {
		global.domainName 	= event.utterance.toss;
		global.lastSpeechEvent	= null;
//		System.out.println("Toss to " + global.domainName);
		return false;
	}

	public boolean npcBehavior_begin(Event event) {
		global.lastCharacterStartedSpeaking	= System.currentTimeMillis();
		return false;
	}
	
	public boolean vrSpeech_partial(Event inEvent) { return false; }

	public boolean vrSpeech_start(Event event) {
		global.lastUserStartedSpeaking	= System.currentTimeMillis();
		return false;
	}

	public boolean vrSpeech_finished_speaking(Event event) {
		global.lastUserStoppedSpeaking	= System.currentTimeMillis();
		return false;
	}

	public boolean dm_prompt(Event event) {
//		long currentTime	= System.currentTimeMillis();
//
//		if (global.lastCharacterStartedSpeaking &lt; global.lastCharacterStoppedSpeaking
//			&amp;&amp; global.lastUserStartedSpeaking &lt; global.lastUserStoppedSpeaking
//			&amp;&amp; (currentTime - global.lastCharacterStoppedSpeaking) &gt;= (Global.kWaitBeforePrompt * 1000)) {
//
//			List&lt;Map&lt;String,Object&gt;&gt; answers = engine.answersForCharacter(global.domainName).findAll( { Map&lt;String,Object&gt; utterance -&gt;
//				utterance.type == Global.kPrompt }).toList();
//			if (!answers.isEmpty()) {
//				Collections.shuffle(answers);
//				send(leastRecent(answers, Global.kHistoryWindow));
//			}
//		}

		return false;
	}

	public Behavior send(Map&lt;String,Object&gt; inUtterance) {
		if (inUtterance != null) {
			if (inUtterance.script) {
				global.lastUtterance	= null;
				return engine.schedule(inUtterance);
			} else {
				global.lastUtterance	= inUtterance;
				Behavior	b	= engine.schedule(inUtterance);
				b.setLock(Behavior.kDefaultLock);
				return b;
			}
		}

		return engine.schedule(inUtterance);
	}

	protected Behavior sendRegular(Map&lt;String,Object&gt; inUtterance) {
		return send(inUtterance);
	}

	public Map&lt;String,Object&gt; utteranceWithID(String inUtterance) {
		return (Map&lt;String,Object&gt;)engine.answers().find({Map&lt;String,Object&gt; utterance -&gt; utterance.ID == inUtterance});
	}

	protected Map&lt;String,Object&gt; leastRecent(List&lt;Map&lt;String,Object&gt;&gt; inAnswers, int inDepth) {
		def selectedUtterance	= null;
		def	depth				= -1;
		for(a in inAnswers) {
			def d	= engine.seenRecently(a, inDepth);
			if (d &gt; depth) {
				depth				= d;
				selectedUtterance	= a;
				if (depth &gt;= inDepth) break;
			}
		}
		return selectedUtterance;
	}

	protected void onexit() { }
	protected void onentry() { }

}

public class Regular extends State {

	int offTopicCount	= 0;

	Regular(Global inGlobal) {
		super(inGlobal);
	}

	public boolean handle(Event event) {
		if (event.event == Event.kLockEventType &amp;&amp; event?.id == Behavior.kDefaultLock) {
			global.setMicrophoneEnabled(engine.executor.canAcquireLock(Behavior.kDefaultLock));
			return false;
		} else if (event.text) {
			return vrSpeech_asr_complete(event);
		} else {
			return super.handle(event);
		}
	}

	protected Behavior sendOfftopic() {
		++offTopicCount;
		return send(randomOfftopic());
	}

	protected Behavior sendRegular(Map&lt;String, Object&gt; inUtterance) {
		offTopicCount	= 0;
		return super.sendRegular(inUtterance);
	}

	private Map&lt;String,Object&gt; randomOfftopic(String inOfftopicType) {
		List&lt;Map&lt;String,Object&gt;&gt; answers = engine.answersForCharacter(global.domainName).findAll( { Map&lt;String,Object&gt; utterance -&gt;
			utterance.type == inOfftopicType }).toList();
		if (answers.isEmpty())
			answers = engine.answersForCharacter(global.domainName).findAll( { Map&lt;String,Object&gt; utterance -&gt;
				utterance.type == Global.kOpaque || utterance.type == Global.kUnknown || utterance.type == Global.kConceal }).toList();
		Collections.shuffle(answers);
		return leastRecent(answers, Global.kHistoryWindow);
	}

	private Map&lt;String,Object&gt; randomOfftopic() {
		String							offTopicType	= Global.kConceal;
		if (offTopicCount == 1) 		offTopicType	= Global.kOpaque;
		else if (offTopicCount == 2) 	offTopicType	= Global.kUnknown;
		return randomOfftopic(offTopicType);
	}
	
	
	public boolean vrSpeech_partial(Event inEvent){
	
		super.vrSpeech_partial(inEvent);	
		
		
		if (!global.isMicrophoneEnabled()) 
		{
			engine.executor.pause();
			global.transitionTo(global.interrupted);
		}
		
	
		return false;
	
	
	}

	public boolean vrSpeech_asr_complete(Event event) {

		if (!event.text || ((String)event.text).trim().length() == 0) return false;

		if (global.domainName == null)
			global.domainName	= (String)event.speaker;


		String currentAddressee;						
		
		currentAddressee = global.addressee.findCurrentAddressee( event.text);

		if ( ( currentAddressee != "") ) {
			event.Addressee	= currentAddressee;
			engine.send("Addressee = "+currentAddressee);
		}


		try {
			List&lt;Map&lt;String,Object&gt;&gt; 	answers				= engine.search(global.domainName, event);

			if (answers.isEmpty()) {
				sendOfftopic();
			} else {
				Map&lt;String,Object&gt;			selectedUtterance = (Map)answers[0];

				if (selectedUtterance.type == Global.kAlternative) {
					if (!global.lastSpeechEvent) {
						sendOfftopic();
					} else {
						offTopicCount	= 0;
						return vrSpeech_asr_complete(global.lastSpeechEvent);
					}
					return false;
				}

				if (selectedUtterance.type == Global.kRepeat) {
					if (!global.lastUtterance) {
						sendOfftopic();
					} else {
						sendRegular(global.lastUtterance);
					}
					return false;
				}

				global.lastSpeechEvent	= event;
				sendRegular(leastRecent(answers,Global.kHistoryWindow));
			}

		} catch (Throwable t) {
			t.printStackTrace();
		}

		return false;
	}

}


class Interrupted extends State {
	Interrupted(Global inGlobal) {
		super(inGlobal);
	}
			

	protected void onentry() {
		
		StopSpeakingAndRespondToNewQuestion();
	}
	


	public boolean StopSpeakingAndRespondToNewQuestion() {

		engine.executor.newExecutionState();	
		global.transitionTo(global.regularState);
		global.setMicrophoneEnabled(true);
		
		return false;
	}
	

}



global.reset();


public class IdentifyAddressee {

    Global global;
    
    String previousAddressee = "Brad";
	
	IdentifyAddressee(Global inGlobal) {
		global	= inGlobal;
	}

    
    public String findCurrentAddressee(String textOfHumanUtterance) {     

        
        String addresseeFromKeyword = findAddresseeFromKeyword(textOfHumanUtterance);
        if (!addresseeFromKeyword.equals("")) {           
        	previousAddressee = addresseeFromKeyword;
            return addresseeFromKeyword;            
        }
        
    }


    
    public String findAddresseeFromKeyword(String textOfHumanUtterance) {
        
        Hashtable bradKeyWord = new Hashtable();
        bradKeyWord.put("brad", new Integer(1));        

        
        Hashtable rachelKeyWords = new Hashtable();
        rachelKeyWords.put("rachel", new Integer(1));
        rachelKeyWords.put("woman", new Integer(1));
        rachelKeyWords.put("miss", new Integer(1));
		rachelKeyWords.put("girl", new Integer(1));
		rachelKeyWords.put("lady", new Integer(1));				
		rachelKeyWords.put("madam", new Integer(1));

        
        String[] utteranceWords = textOfHumanUtterance.split(" ");

        for (String word : utteranceWords) {
            if (bradKeyWord.containsKey(word.toLowerCase())) {
                return "Brad";
            }
            if (rachelKeyWords.containsKey(word.toLowerCase())) {				
                return "Rachel";
            }
        }
        return "";
    }


    
    public boolean isOnScene(String character) {
        
        Set presentCharacters = global.getPresentCharacters();

        if (presentCharacters.contains(character)) {
            return true;
        }

        return false;
    }


}</string>
<key>scriptEngineName</key>
<string>groovy</string>
</dict>
<key>class</key>
<string>edu.usc.ict.npc.editor.dialog.script.ScriptableDialogManager</string>
</dict>
<key>evaluationFrameworkProvider</key>
<dict>
<key>class</key>
<string>edu.usc.ict.npc.editor.model.EvaluationFrameworkProvider$MeanFScoreEvaluationFramework</string>
</dict>
<key>loggingConversations</key>
<false/>
</dict>
</plist>
